@node sntp Invocation
@section Invoking sntp
@pindex sntp
@cindex standard Simple Network Time Protocol program
@ignore
# 
# EDIT THIS FILE WITH CAUTION  (sntp-opts.texi)
# 
# It has been AutoGen-ed  April 21, 2011 at 06:16:08 AM by AutoGen 5.11.6
# From the definitions    sntp-opts.def
# and the template file   aginfo.tpl
@end ignore

@code{sntp}
can be used as a SNTP client to query a NTP or SNTP server and either display
the time or set the local system's time (given suitable privilege).  It can be
run as an interactive command or in a
@code{cron}
job.

NTP (the Network Time Protocol) and SNTP (the Simple Network Time Protocol)
are defined and described by RFC 5905.

@indent
The default is to write the estimated correct local date and time (i.e. not
UTC) to the standard output in a format like
@example
1996-10-15 20:17:25.123 (+0800) +4.567 +/- 0.089 secs
@end example
where the
@example
+4.567 +/- 0.089 secs
@end example
indicates the local clock is 4.567 seconds behind the correct time
(so 4.567 seconds must be added to the local clock to get it to be correct),
and the (local) time of
@code{1996-10-15 20:17:25.123}
can be converted to UTC time by adding 8 hours and 0 minutes, and
is believed to be correct to within
@code{+/- 0.089}
seconds.

This section was generated by @strong{AutoGen},
the aginfo template and the option descriptions for the @command{sntp} program.  It documents the sntp usage text and option meanings.

This software is released under a specialized copyright license.

@menu
* sntp usage::                  sntp usage help (-?)
* sntp authentication::        authentication option (-a)
* sntp bctimeout::             bctimeout option (-B)
* sntp broadcast::             broadcast option (-b)
* sntp concurrent::            concurrent option (-c)
* sntp debug-level::           debug-level option (-d)
* sntp filelog::               filelog option (-l)
* sntp headspace::             headspace option (-h)
* sntp ipv4::                  ipv4 option (-4)
* sntp ipv6::                  ipv6 option (-6)
* sntp keyfile::               keyfile option (-k)
* sntp kod::                   kod option (-K)
* sntp ntpversion::            ntpversion option (-o)
* sntp set-debug-level::       set-debug-level option (-D)
* sntp slew::                  slew option (-s)
* sntp step::                  step option (-S)
* sntp steplimit::             steplimit option (-M)
* sntp uctimeout::             uctimeout option (-u)
* sntp usereservedport::       usereservedport option (-r)
* sntp wait::                  wait option
@end menu

@node sntp usage
@subsection sntp usage help (-?)
@cindex sntp usage

This is the automatically generated usage text for sntp:

@exampleindent 0
@example
sntp - standard Simple Network Time Protocol program - Ver. 4.2.7p157
USAGE:  sntp [ -<flag> [<val>] | --<name>[@{=| @}<val>] ]... \
                [ hostname-or-IP ...]
  Flg Arg Option-Name    Description
   -d no  debug-level    Increase output debug message level
                                - may appear multiple times
   -D Str set-debug-level Set the output debug message level
                                - may appear multiple times
   -4 no  ipv4           Force IPv4 DNS name resolution
                                - prohibits these options:
                                ipv6
   -6 no  ipv6           Force IPv6 DNS name resolution
                                - prohibits these options:
                                ipv4
   -a Num authentication Enable authentication with the key auth-keynumber
   -B Num bctimeout      The number of seconds to wait for broadcasts
   -b Str broadcast      Listen to the address specified for broadcast time sync
                                - may appear multiple times
   -c Str concurrent     Concurrent query all IPs returned for host-name
                                - may appear multiple times
   -h Num headspace      The gap (in milliseconds) between time requests
   -K Fil kod            KoD history filename
   -k Fil keyfile        Look in this file for the key specified with -a
   -l Fil filelog        Log to specified logfile
   -M Num steplimit      Adjustments less than steplimit msec will be slewed.
                                - it must be:  greater than or equal to 0
   -o Num ntpversion     Send <int> as our NTP version
                                - it must be:  0 to 7
   -r no  usereservedport Use the NTP Reserved Port (port 123)
   -S no  step           OK to 'step' the time with settimeofday()
   -s no  slew           OK to 'slew' the time with adjtime()
   -u Num uctimeout      The number of seconds to wait for unicast responses
      no  wait           Wait for pending replies (if not setting the time)
                                - disabled as --no-wait
                                - enabled by default
      opt version        Output version information and exit
   -? no  help           Display extended usage information and exit
   -! no  more-help      Extended usage information passed thru pager
   -> opt save-opts      Save the option state to a config file
   -< Str load-opts      Load options from a config file
                                - disabled as --no-load-opts
                                - may appear multiple times

Options are specified by doubled hyphens and their name or by a single
hyphen and the flag character.



The following option preset mechanisms are supported:
 - reading file $HOME/.ntprc
 - reading file ./.ntprc
 - examining environment variables named SNTP_*

sntp implements the Simple Network Time Protocol and is used to query an
NTP or SNTP server and either display the time or set the local system's
time (given suitable privilege).

It can be run interactively from the command line or as a cron job.

NTP and SNTP are defined by RFC 5905, which obsoletes RFC 4330 and RFC
1305.

please send bug reports to:  http://bugs.ntp.org, bugs@@ntp.org
@end example
@exampleindent 4

@node sntp authentication
@subsection authentication option (-a)
@cindex sntp-authentication

This is the ``enable authentication with the key auth-keynumber'' option.
This option enables authentication using the key specified in this option's argument.
The argument of this option is the keyid, a number specified in the keyfile as this
key's identifier. See the keyfile option (-k) for more details.

@node sntp bctimeout
@subsection bctimeout option (-B)
@cindex sntp-bctimeout

This is the ``the number of seconds to wait for broadcasts'' option.
When waiting for a broadcast packet SNTP will wait the number
of seconds specified before giving up.  Default 68 seconds.

@node sntp broadcast
@subsection broadcast option (-b)
@cindex sntp-broadcast

This is the ``listen to the address specified for broadcast time sync'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
may appear an unlimited number of times.
@end itemize

If specified SNTP will listen to the specified address
for NTP broadcasts.  The default maximum wait time,
68 seconds, can be modified with -B.

@node sntp concurrent
@subsection concurrent option (-c)
@cindex sntp-concurrent

This is the ``concurrent query all ips returned for host-name'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
may appear an unlimited number of times.
@end itemize

Requests from an NTP "client" to a "server" should never be sent
more rapidly than one every 2 seconds.  By default, any IPs returned
as part of a DNS lookup are assumed to be for a single instance of
ntpd, and therefore sntp will send  queries to these IPs one after
another, with a 2-second gap in between each query.

The -c or --concurrent flag says that any IPs returned for the
DNS lookup of the supplied host-name are on different machines,
so we can send concurrent queries.

@node sntp debug-level
@subsection debug-level option (-d)
@cindex sntp-debug-level

This is the ``increase output debug message level'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
may appear an unlimited number of times.
@end itemize

Increase the debugging message output level.

@node sntp filelog
@subsection filelog option (-l)
@cindex sntp-filelog

This is the ``log to specified logfile'' option.
This option causes the client to write log messages to the specified
logfile.

@node sntp headspace
@subsection headspace option (-h)
@cindex sntp-headspace

This is the ``the gap (in milliseconds) between time requests'' option.
Since we're only going to use the first valid response we get and
there is benefit to specifying a good number of servers to query,
separate the queries we send out by the specified number of
milliseconds.
Default 10 milliseconds.

@node sntp ipv4
@subsection ipv4 option (-4)
@cindex sntp-ipv4

This is the ``force ipv4 dns name resolution'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
must not appear in combination with any of the following options:
ipv6.
@end itemize

Force DNS resolution of following host names on the command line
to the IPv4 namespace.

@node sntp ipv6
@subsection ipv6 option (-6)
@cindex sntp-ipv6

This is the ``force ipv6 dns name resolution'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
must not appear in combination with any of the following options:
ipv4.
@end itemize

Force DNS resolution of following host names on the command line
to the IPv6 namespace.

@node sntp keyfile
@subsection keyfile option (-k)
@cindex sntp-keyfile

This is the ``look in this file for the key specified with -a'' option.
This option specifies the keyfile. SNTP will search for the key specified with -a keyno in this
file. Key files follow the following format:

keyid keytype key

Where	keyid is a number identifying this key
keytype is one of the follow:
S  Key in 64 Bit hexadecimal number as specified in in the DES specification.
N  Key in 64 Bit hexadecimal number as specified in the NTP standard.
A  Key in a 1-to-8 character ASCII string.
M  Key in a 1-to-8 character ASCII string using the MD5 authentication scheme.

For more information see ntp.keys(5).

@node sntp kod
@subsection kod option (-K)
@cindex sntp-kod

This is the ``kod history filename'' option.
Specifies the filename to be used for the  persistent history of KoD
responses received from servers.  The default is
/var/db/ntp-kod.

@node sntp ntpversion
@subsection ntpversion option (-o)
@cindex sntp-ntpversion

This is the ``send <int> as our ntp version'' option.
When sending requests to a remote server, tell them we are running
NTP protocol version <ntpversion> .

@node sntp set-debug-level
@subsection set-debug-level option (-D)
@cindex sntp-set-debug-level

This is the ``set the output debug message level'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
may appear an unlimited number of times.
@end itemize

Set the output debugging level.  Can be supplied multiple times,
but each overrides the previous value(s).

@node sntp slew
@subsection slew option (-s)
@cindex sntp-slew

This is the ``ok to 'slew' the time with adjtime()'' option.


@node sntp step
@subsection step option (-S)
@cindex sntp-step

This is the ``ok to 'step' the time with settimeofday()'' option.


@node sntp steplimit
@subsection steplimit option (-M)
@cindex sntp-steplimit

This is the ``adjustments less than steplimit msec will be slewed.'' option.
If the time adjustment is less than steplimit milliseconds, slew the amount using adjtime().  Otherwise, step the correction using settimeofday().

@node sntp uctimeout
@subsection uctimeout option (-u)
@cindex sntp-uctimeout

This is the ``the number of seconds to wait for unicast responses'' option.
When waiting for a unicast reply, SNTP will wait the number
of seconds specified before giving up.  Default 5 seconds.

@node sntp usereservedport
@subsection usereservedport option (-r)
@cindex sntp-usereservedport

This is the ``use the ntp reserved port (port 123)'' option.
Use port 123, which is reserved for NTP, for our network communications.

@node sntp wait
@subsection wait option
@cindex sntp-wait

This is the ``wait for pending replies (if not setting the time)'' option.

This option has some usage constraints.  It:
@itemize @bullet
@item
is enabled by default.
@end itemize

If we are not setting the time, wait for all pending responses.
