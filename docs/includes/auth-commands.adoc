// Authentication commands - included twice

The following declarations control MAC authentication:

[[controlkey]]
+controlkey+ _key_::
  Specifies the key identifier to use with the
  {ntpqman} utility, which uses the standard protocol defined in
  RFC 5905. The _key_ argument is the key identifier for a trusted key,
  where the value can be in the range 1 to 65,535, inclusive.

[[keys]]
+keys+ _keyfile_::
  Specifies the complete path and location of the key file
  containing the keys and key identifiers used by {ntpdman},
  and {ntpqman} when operating with symmetric-key cryptography.
  This is the same operation as the +-k+ command line option.

[[trustedkey]]
+trustedkey+ _key..._ ::
  Specifies the key identifiers which are trusted for the purposes of
  authenticating peers with symmetric key cryptography, as well as keys
  used by the {ntpqman} program.
  Multiple keys on the same line should be separated by spaces.
  Key ranges can be specified as (first ... last).  The spaces around
  the ... are necessary.  Multiple +trustedkey+ lines are supported
  and trusted keys can also be specified on the command line.

The MAC authentication procedures require that both the local and remote
servers share the same key and key identifier for this purpose,
although different keys can be used with different servers.
The _key_ arguments are 32-bit unsigned integers with values from 1 to
65,535.

The following command controls NTS authentication. It overrides
normal TLS protocol negotiation, which is not usually necessary.

[[crypto]]
+crypto+ [+mintls+ _version_] [+maxtls+ _version_] [+tlsciphers+ _name_] [+tlsciphersuites+ _name_]

The options are as follows:

+mintls+ _number_::
  Set the lowest allowable TLS version to negotiate. Will be useful in
  the wake of a TLS compromise.

+maxtls+ _number_::
  Set the highest allowable TLS version to negotiate. By setting
  +mintls+ and +maxtls+ equal, you can force the TLS version for testing.

// https://crypto.stackexchange.com/questions/8964/sending-tls-messages-with-out-encryption-using-openssl-code
+tlsciphers+ _string_::
   An OpenSSL cipher list to configure the allowed ciphers for TLS
   versions up to and including TLS 1.2. An empty string disables encryption.

+tlsciphersuites+ _string_::
   An OpenSSL ciphersuite list to configure the allowed ciphersuites for
   TLS 1.3. An empty string disables encryption.

The following options of the +server+ command configure NTS.

+nts+::
  Use Network Time Security for authentication and encryption.
  Request key exchange from the NTP server.  If there is an NTS
  key service running in the same host as the NTP server adding this
  option is normally all you need to do.

+ask+ _address_::
  Use Network Time Security for authentication and encryption.  Ask
  for a specific NTS server, which may differ from the NTP server.
  Conforms to RFC3896 section 3.2.2 prescription for the Host part of
  a URI: that is, the +address_ may be a hostname, a FQDN, an IPv4
  numeric address, an IPv6 numeric address (in square brackets).
  Address may have the suffix +:port+ to specify a UDP port.

+require+ _address_::
  Use Network Time Security for authentication and encryption.
  Require a specific NTS server, which may differ from the NTP server.
  Address syntax is as for +ask+.

+noval+::
  Do not validate the server certificate.

+expire+::
  How long to use a secured NTP association before rekeying with the
  NTS-KE server.

+cert+ _file_::
  Present the certificate in _file_ as our client certificate

+ca+ _location_::
  Use the file, or directory, specified by _location_ to
  validate the NTS-KE server certificate.  Do not use any other CA.
// end
