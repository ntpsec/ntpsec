<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
<meta name="generator" content="HTML Tidy, see www.w3.org">
<title>Autokey Public-Key Authentication</title>
<link href="scripts/style.css" type="text/css" rel="stylesheet">
<style type="text/css">
<!--
.style1 {color: #FF0000}
-->
</style>
</head>
<body>
<h3>Autokey Public-Key Authentication</h3>
<p>Last update:
  <!-- #BeginDate format:En2m -->12-Dec-2010  21:14<!-- #EndDate -->
  UTC</p>
<hr>
<h4>Table of Contents</h4>
<ul>
  <li class="inline"><a href="#intro">Introduction</a></li>
  <li class="inline"><a href="#group">NTP Secure Groups</a></li>
  <li class="inline"><a href="#ident">Identity Schemes and Cryptotypes</a></li>
  <li class="inline"><a href="#cfg">Configuration</a></li>
  <li class="inline"><a href="#exam">Examples</a></li>
</ul>
<hr>
<h4 id="intro">Introduction</h4>
<p>This distribution includes support for the  Autokey public key algorithms and protocol specified in RFC-5906 &quot;Network Time Protocol Version 4: Autokey Specification&quot;. This support is available only if the OpenSSL library has been installed and the <tt>--enable-autokey</tt> option   is specified when the distribution is built.</p>
<p> Public key cryptography is generally considered more secure than symmetric key cryptography. Symmetic key cryptography is based on a shared secret which must be distributed by secure means to all participats. Public key cryptography is based on a private secret key known only to the originator and a public key known to all participants. A recipient can verify the originator has the correct private key using the public key and any of several digital signature algortihms.</p>
<p>The Autokey Version 2 protocol described on the <a href="http://www.eecis.udel.edu/%7emills/proto.html">Autokey Protocol</a> page verifies packet integrity using  message digest algorithms, such as MD5 or SHA,  and verifies the source using  any of several digital signature schemes, such as RSA or DSA.  As used in Autokey, message digests are exceptionlly difficult to cryptanalyze, as the keys are used only once.</p>
<p> Optional identity schemes described on the <a href="http://www.eecis.udel.edu/~mills/ident.html">Autokey Identity Schemes</a> page are based on cryptographic challenge/response exchanges.  Identity schemes provide strong security against  masquerade and most forms of clogging attacks. These schemes are exceptionally difficulat to cryptanalyze, as the challenge/responsee exchange data are used only once. They  are described along with an executive summary, current status, briefing slides and reading list on the <a href="http://www.eecis.udel.edu/~mills/autokey.html">Autonomous Authentication</a> page.</p>
<p>Autokey authenticates individual packets using cookies bound to the IP source and destination addresses. The cookies must have the same addresses at both the server and client. For this reason operation with network address translation schemes is not possible. This reflects the intended robust security model where government and corporate NTP servers are operated outside firewall perimeters.</p>
<p>Auokey is designed to authenticate servers to clients, not the other way around as in SSH.  An Autokey server can support an authentication scheme such as the Trusted Certificate (TC) scheme described in RFC 5905, whle a client is free to choose between the various options. It is important to understand that these provisions are optional and that selection of which option is at the discretion of the client. If the client does not require authentication, it is free to ignore it, even if some other client of the same server elects to participate in either symmetric key or public key cryptography.</p>
<p> Autokey uses industry standard X.509 public certificates, which can be produced by commercial services, utility programs in the OpenSSL software library and the <a href="keygen.html"><tt>ntp-keygen</tt></a> utility program in the NTP software distribution.  A certificate includes the subject name of the client, the issuer name of the server, the public key of the server and the time  period over which the the server public and private keys are valid.   All Autokey hosts have  a self-signed certificate with   the  Autokey name as both the subject and issuer. During the protocol, additional certificates are produces with the Autokey host name as subject and the host that signs the certificate as issuer.</p>
<h4 id="cert">Autokey Subnets</h4>
<p> An Autokey subnet consists of a collection of hosts configured as an acyclic, directed tree with roots one or more trusted hosts (THs) operating at the lowest stratum of the subnet. The THs are synchronized  directly or indirectly to national time services via trusted means, such as radio, satellite or telephone modem, or a  private, dedicated NTP subnet. Autokey hosts operate as servers, clients or both at the same time.</p>
<p>A certificate trail is a sequence of certificates, each signed by a host  nearer the THs and terminating at the self-signed certificate of a Th. As the Autokey protocol proceeds,  each client provides its self-signed certificate to a server  nearer  the THs for signature. In order for the signature to succeed, the client certificate valid period  must begin within the valid period  of the server certificate.  If  the server period begins later than the client period, the client certificate has expired; if the client period begins later than the server period, the server certificate has expired.  While the certificate trail authenticates each host on the trail to  the THs, it does not  verify the validity of the time values themselves. Ultimately, this is determined by the NTP on-wire protocool.</p>
<p>The Autokey protocol runs for each association separately. During the protocol the client recursively obtains all the certificates on the trail to a TH, saving each in a cache ordered from most recent to oldest. If an expired certificate is found, it is invalidate, but marked for later replacement. As the client certificate itself is not involved in the certificate trail, it can only be declared valid or expired when the server  signs it. </p>
<p>The certificates derived from each association are combined in the cache with duplicates suppressed. If it happens that two different associations contribute certificates to the cache, a certificate on the trail from one association  could expire before any on another trail. In this case the remaining trails  will survive until the expired certificate is replaced. Once saved in the cache, a certificate remains valid until it expires or is replaced by a new one.</p>
<p> It is important to note that the certificate trail is validated only at startup when an association is mobilized. Once validated in this way,  the server remains validated until it  is demobilized, even if  certificates on the trail to the THs expire.</p>
<h4 id="group">NTP Secure Groups</h4>
<p>NTP security groups are and extension of NTP subnets. They include in addition to certificate trails one or another identity schemes described on the <a href="http://www.eecis.udel.edu/~mills/ident.html">Autokey Identity Schemes</a> page. NTP secure groups are used to define cryptographic compartments and security
  hierarchies. The identity scheme insures that the server is authentic and not masqueraded by an intruder acting as a middleman.</p>
<p> As in NTP subnets, the THs are at the lowest stratum of the secure group. For secure group THs the string specified by the <tt>-s</tt> option of the <tt>ntp-keygen</tt> program is the name used as the subject and issuer of the trusted certificate and is also the name of the secure group. This name must match the <tt>ident</tt> option
  of the <tt>crypto</tt> command, which is the group name for all  group hosts and the
  name used in the identity files. The file naming conventions are described on
  the <a href="keygen.html">ntp-keygen</a> page.</p>
<p>The Autokey identity schemes involve a challenge-response exchange where a client generates a nonce and sends to the server. The server performs a mathematical operation involving a second nonce and a secret key, and sends the result along with a hash to the client. The client performs a another mathematical operation and verifies the result with the hash. Since each exchange involves two nonces, even after repeated observations of many exchanges, an intruder cannot learn the secret group key. It is this quality that allows the secure group key to persist long after the longest period of certificate validity. In the Schnorr IFF scheme considered in this section, the secret group key is not divulged to the clients, so they cannot conspire to prove identity to other hosts.</p>
<p>As in NTP subnets, each secure group includes one or more trusted hosts (THs) operating at the  lowest stratum in the group. For THs the  group name specified by the -i option of the ntp_keygen program and the ident option of the crypto command is used as the subject and issuer  of the TH self-signed trusted certificate.   For the IFF scheme, the other group hosts need only the crypto command with no options. </p>
<p>As in NTP subnet, NTP secure group hosts are configured as an acyclic tree rooted on the THs. All group hosts construct an  unbroken  certificate trail from each host, possibly via intermediate hosts, and ending at a TH. In addition, each group host verifies the server has the secret key using the identity exchange. When a host starts up, it recursively retrieves the certificates along the trail to the TH in order to verify group membership and avoid masquerade and middleman attacks.</p>
<h4 id="cfg">NTP Secure Group Configuration</h4>
<p> The simplest scenario consists of a TH where the host name of the TH is also the name of the group. For the simplest identity scheme TC, the TH generates host key and trusted certificate files using the <tt>ntp-keygen -T</tt> command, while the remaining group hosts use the same command with no options to generate the host key and public certificate files. All hosts use the <tt>crypto</tt> configuration command with no options. Configuration with passwords is described in the <a href="keygen.html">ntp-keygen</a> page. All group hosts are configured as an acyclic tree with root the TH.</p>
<p>An NTP secure group is an NTP subnet consisting of one or more low-stratum trusted hosts (THs) as the root from which all other group hosts derive synchronization directly or indirectly. For authentication purposes all hosts in a group must have the same group name specified by the <tt>ident</tt> option of the <tt>crypto</tt> command, in the case of servers, or by the <tt>ident</tt> option of the <tt>server</tt> configuration command, in the case of clients.   Group names are used only for authentication purposes and have nothing to do with DNS names.</p>
<p> For THs the group name is specified by the <tt>-i</tt> option of the <tt>ntp-keygen</tt> program and must match the <tt>ident</tt> option of the <tt>crypto</tt> configuration command. For other hosts the group name is specified by the <tt>ident</tt> option of the <tt>server</tt> configuration command. <span class="style1">In the latest version of this program, the host name and group name are independent of each other and the <tt>host</tt> option of the <tt>crypto</tt> command is deprecated. When compatibility with older versions is required, specify the same name for both the <tt>-s</tt> and <tt>-i</tt> options.</span></p>
<p>As described on the <a href="authopt.html">Authentication Options</a> page, there are five identity schemes, three of which - IFF, GQ and MV - require identity files specific to each scheme. There are two types of files for each scheme, an encrypted keys file  and a nonencrypted parameters file, which usually contains a subset of the keys file. In general,   NTP hosts operating as certificate  authorities (CAs) use the keys file and clients use the parameters file. The TAs include the THs and those group servers with dependent clients.</p>
<p>The parameters files are public; they can be stored in a public place and sent in the clear. The keys files are encrypted with the local password. To retrieve the keys file, a host can send a mail request to the TA including its local password. The TA encrypts the keys file with this password and returns it as an attachment. The attachment is then copied intact to the keys directory with name given in the first line of the file, but all in lower case and with the filestamp deleted. Alternatively, the parameters file can be generated using the <tt>-e</tt> option of the <a href="keygen.html">ntp-keygen</a> program.</p>
<p>When an identity scheme is included, for example IFF, the TH generates host
  key, trusted certificate and private server identity key files using the <tt>ntp-keygen
    -T -I -i <i>group</i></tt> command, where <tt><i>group</i></tt> is the group
  name. The remaining group hosts use the same command as above. All hosts
  use the <tt>crypto ident group<i></i></tt> configuration command.</p>
<p>Hosts with no dependent clients can retrieve client parameter files from an
  archive or web page. The <tt>ntp-keygen</tt> can export these data using the <tt>-e</tt> option.
  Hosts with dependent clients other than the TH must retrieve copies of the server
  key files using secure means. The <tt>ntp-keygen</tt> can export these data
  using the <tt>-q</tt> option. In either case the data are installed as a file
  and then renamed using the name given as the first line in the file, but without
  the filestamp.</p>
<h4 id="config">Configuration - Authentication Scheme</h4>
<p>Autokey has an intimidating number of authentication options, most of which are not necessary in typical scenarios. However, the  Trusted Certificate (TC) scheme is recommended for  national NTP time services, such as those operated by NIST and USNO. Configuration for TC is very simple. For each server, e.g.  <tt>time.nist.gov,</tt> as root:</p>
<p><tt># cd /usr/local/etc<br>
# ntp-keygen -T</tt></p>
<p>This generates an RSA private/public host key file and a self-signed certificate file for  the RSA digital signature algorithm  with  the MD5 message digest algorithm. Include in the <tt>ntp.conf</tt> configuration file something like</p>
<p><tt># disable kernel<br>
  # server 127.127.18.1	minpoll 12 maxpoll 17 # ACTS modem<br>
# phone atdt913035547785 atddt913034944774<br>
  # crypto<br>
# driftfile /etc/ntp.drift</tt></p>
<p>Note the first three lines  are specific to the ACTS driver and NIST modem telephone  numbers. The second number will be tried if the first times out. Alternatively, any other reference clock can be used, or even another time server.</p>
<p>For each client, e.g. <tt>grundoon.udel.edu,</tt> as root:</p>
<p><tt># cd /usr/local/etc<br>
# ntp-keygen</tt></p>
<p>(There is no -<tt>T</tt> option). Include in the <tt>ntp.conf</tt> configuration file something like</p>
<p><tt># server time.nist.gov iburst autokey<br>
 # crypto<br>
# driftfile /etc/ntp.drift</tt></p>
<p>It is possible to configure clients  of server <tt>grundoon.udel.edu</tt> in the same way with the server line pointing to <tt>grundoon.udel.edu</tt>. Dependent clients  authenticate to <tt>time.nistg.gov</tt> through <tt>grundoon.udel.edu</tt>.</p>
<p>In the above configuration examples, the default Autokey host name is the string  returned by the Unix <tt>gethostname()</tt> library routine. This name has nothing to do with the DNS name of the host. The Autokey host name is used as the subject and issuer names on the certificate, as well as the default  password for the encrypted key files. The  Autokey host name can be changed using the <tt>-s</tt> option of the <tt>ntp-keygen</tt> program. The default password can be changed using the <tt>-p</tt> option of the <tt>ntp-keygen</tt> program and the <tt>pw</tt> option of the <tt>crypto</tt> command.</p>
<h4 ident="ident">Configuration - Identity Schemes</h4>
<p>An authentication scheme such as TC can be augmented by an identify scheme to form a secure group. For example, the TA generates encrypted host key and IFF key files and nonencrypted trusted certificate using the command</p>
<p><tt>ntp-keygen -p <em>server_password </em>-T -I -i group<i>,</i></tt></p>
<p>where <tt>group_name</tt> is the group name used by all hosts in the group. Each client host generates encrypted host keys and nonencrypted, nontrusted certificate using the  command</p>
<p><tt>ntp-keygen -p <i>client_passwd</i></tt></p>
<p>Once these media have been generated, the TA can then generate the public parameters using the command</p>
<p><tt>ntp-keygen -p <em>local_passwd</em> -e &gt;<i>parameters_file</i></tt></p>
<p>where the <tt>-e</tt> option redirects the unencrypted client parameters to the standard output stream for a mail application or stored locally for later distribution. In a similar fashion the <tt>-q</tt> option redirects the encrypted server keys to the standard output stream using the command</p>
<p><tt>ntp-keygen -p <em>local_passwd</em> -q <em>remote_password</em> -e &gt;<i>keys_file</i></tt></p>
<p>In special circumstances the Autokey message digest algorithm can be changed using the <tt>digest</tt> option of the <tt>crypto</tt> command. The  digest algorithm is separate and distinct from the symmetric
key message digest algorithm.   If compliance with FIPS 140-2 is required,
the algorithm must be ether <tt>SHA</tt> or <tt>SHA1</tt>. The Autokey message digest algorithm must be the same for  all participants in the NTP subnet (see next section). The message digest/digital signature scheme can be changed for each server separately using the <tt>-c</tt>  option of the <tt>ntp_keygen</tt> program. This applies only for clients of that server, which select whatever scheme the server specifies.</p>
<p>It is important to note that certificates have a defined lifetime of one year from the time of creation. Sometime toward the end of the liftetime period, it is necessary to create a new certificate at both the server and client. For each server and client as root:</p>
<p><tt># ntp_keygen</tt></p>
<p>The options are copied from the current certificate.</p>
<p>There are two timeouts associated with the Autokey scheme. The <em>key list timeout</em> is set by the <tt>automax</tt> command, which  specifies the interval between generating new key lists by the client. The default timeout of about 1.1 hr is appropriate for the majority of configurations and ordinarily should not be changed. The <em>revoke timeout</em> is set by the <tt>revoke</tt> command, which  specifies the interval between generating new server private values. It is intended to reduce the vulnerability to cryptanalysis; however,  new values  require the server to encrypt each client cookie separately. The default timeout of about 36 hr is appropriate for most  servers, but might be too short for national time servers.</p>
<h4 id="exam">Examples</h4>
<div align="center"> <img src="pic/group.gif" alt="gif"> </div>
<p>Consider a scenario involving three secure groups RED, GREEN and BLUE. RED and BLUE are typical of national laboratories providing certified time to the Internet at large. As shown ion the figure, RED TH mort and BLUE TH macabre run NTP symmetric mode with each other for monitoring or backup. For the purpose of illustration, assume both THs are primary servers. GREEN is typical of a large university providing certified time to the campus community. GREEN TH howland is a broadcast client of both RED and BLUE. BLUE uses the IFF scheme, while both RED and GREEN use the GQ scheme, but with different keys. YELLOW is a client of GREEN and for purposes of illustration a TH for YELLOW.</p>
<p>The BLUE TH macabre uses configuration commands</p>
<p><tt>crypto pw qqsv ident blue</tt><br>
  <tt>peer mort autokey</tt><br>
  <tt>broadcast <i>address</i> autokey</tt></p>
<p>where <tt>qqsv</tt> is the password for macabre files and <i>address</i> is the broadcast address for the local LAN. It generates BLUE files using the commands</p>
<p><tt>ntp-keygen -p qqsv -T -G -i blue</tt><br>
  <tt>ntp-keygen -p qqsv -e &gt;ntpkey_gqpar_blue</tt></p>
<p>The first line generates the host, trusted certificate and private GQ server keys file. The second generates the public GQ client parameters file, which can have any nonconflicting mnemonic name.</p>
<p>The RED TH mort uses configuration commands</p>
<p><tt>crypto pw xxx ident red</tt><br>
  <tt>peer macabre autokey</tt><br>
  <tt>broadcast <i>address</i> autokey</tt></p>
<p>where <tt>xxx</tt> is the password for mort files. It generates RED files using the commands</p>
<p><tt>ntp-keygen -p xxx -T -I -i red</tt><br>
  <tt>ntp-keygen -p xxx -e &gt;ntpkey_iffpar_red</tt></p>
<p> The GREEN TH howland uses configuration commands</p>
<p><tt>crypto pw yyy ident green</tt><br>
  <tt>broadcastclient</tt></p>
<p>where <tt>yyy</tt> is the password for howland files. It generates GREEN files using the commands</p>
<p><tt>ntp-keygen -p yyy -T -G -i green</tt><br>
  <tt>ntp-keygen -p yyy -e &gt;ntpkey_gqpar_green</tt><br>
  <tt>ntp-keygen -p yyy -q zzz &gt;zzz_ntpkey_gqkey_green</tt></p>
<p>The first two lines serve the same purpose as the preceding examples. The
  third line generates a copy of the private GREEN server file for use on another
  server in the same group, say YELLOW, but encrypted with the <tt>zzz</tt> password.</p>
<p>A client of GREEN, for example YELLOW, uses the configuration commands</p>
<p><tt>crypto pw abc ident green</tt><br>
  <tt>server howland autokey</tt></p>
<p>where <tt>abc</tt> is the password for its files. It generates files using the command</p>
<p><tt>ntp-keygen -p abc</tt></p>
<p>The client retrieves the client file for that group from a public archive or web page using nonsecure means. In addition, each server in a group retrieves the private server keys file from the TH of that group, but it is encrypted and so must be sent using secure means. The files are installed in the keys directory with name taken from the first line in the file, but without the filestamp.</p>
<p>Note that if servers of different groups, in this case RED and BLUE, share the same broadcast media, each server must have client files for all groups other than its own, while each client must have client files for all groups. Note also that this scenario is for illustration only and probably would not be wise for practical use, as if one of the TH reference clocks fails, the certificate trail becomes cyclic. In such cases the symmetric path between RED and BLUE, each in a different group, would not be a good idea.</p>
<h4 id="ident2">Identity Schemes and Cryptotypes</h4>
<p>All configurations include a public/private host key pair and matching certificate. Absent an identity scheme, this is a Trusted Certificate (TC) scheme. There are three optional identity schemes, IFF, GQ and MV described on the <a href="http://www.eecis.udel.edu/%7emills/ident.html">Identity Schemes</a> page. With these schemes all servers in the group have encrypted server identity keys, while clients have nonencrypted client identity parameters. The client parameters can be obtained from a trusted agent (TA), usually one of the THs of the lower stratum group. Further information on identity schemes is on the <a href="http://www.eecis.udel.edu/~mills/ident.html">Autokey Identity Schemes</a> page.</p>
<p>A specific combination of authentication and identity schemes is called a <em>cryptotype</em>, which applies to clients and servers separately. A group can be
  configured using more than one cryptotype combination, although not all combinations
  are interoperable. Note however that some cryptotype combinations may successfully
  intemperate with each other, but may not represent good security practice. The
  server and client cryptotypes are defined by the the following codes.</p>
<dl>
  <dt>NONE</dt>
  <dd>A client or server is type NONE if authentication is not available or not configured. Packets exchanged between client and server have no MAC.</dd>
  <dt>AUTH</dt>
  <dd>A client or server is type AUTH&nbsp;if the <tt>key</tt> option is specified with the <tt>server</tt> configuration command and the client and server keys are compatible. Packets exchanged between clients and servers have a MAC.</dd>
  <dt>PC</dt>
  <dd>A client or server is type PC if the <tt>autokey</tt> option is specified with the <tt>server</tt> configuration command and compatible host key and private certificate files are present. Packets exchanged between clients and servers have a MAC.</dd>
  <dt>TC</dt>
  <dd>A client or server is type TC  if the <tt>autokey</tt> option is specified with the <tt>server</tt> configuration command and compatible host key and public certificate files are present. Packets exchanged between clients and servers have a MAC.</dd>
  <dt>IDENT</dt>
  <dd>A client or server is type IDENT  if the <tt>autokey</tt> option is specified with the <tt>server</tt> configuration command and compatible host key, public certificate and identity scheme files are present. Packets exchanged between clients and servers have a MAC.</dd>
</dl>
<p>The compatible cryptotypes for clients and servers are listed in the following table.</p>
<table width="100%" border="1" cellpadding="4">
  <tr>
    <td rowspan="2" align="center">Client</td>
    <td colspan="5" align="center">Server</td>
  </tr>
  <tr>
    <td align="center">NONE</td>
    <td align="center">AUTH</td>
    <td align="center">PC</td>
    <td align="center">TC</td>
    <td align="center">IDENT</td>
  </tr>
  <tr>
    <td align="center">NONE</td>
    <td align="center">yes</td>
    <td align="center">yes*</td>
    <td align="center">yes*</td>
    <td align="center">yes*</td>
    <td align="center">yes*</td>
  </tr>
  <tr>
    <td align="center">AUTH</td>
    <td align="center">no</td>
    <td align="center">yes</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">no</td>
  </tr>
  <tr>
    <td align="center">PC</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">yes</td>
    <td align="center">no</td>
    <td align="center">no</td>
  </tr>
  <tr>
    <td align="center">TC</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">yes</td>
    <td align="center">yes</td>
  </tr>
  <tr>
    <td align="center">IDENT</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">no</td>
    <td align="center">yes</td>
  </tr>
</table>
<p>* These combinations are not valid if the restriction list includes the <tt>notrust</tt> option.</p>
<p>&nbsp;</p>
<h4 id="err">Error Codes</h4>
<p>Errors can occur due to mismatched configurations, unexpected protocol restarts, expired certificates and unfriendly people. In most cases the protocol state machine recovers automatically by retransmission, timeout and restart, where necessary. Some errors are due to mismatched keys, digest schemes or identity schemes and must be corrected by installing the correct media and/or correcting the configuration file. One of the most common errors is expired certificates, which must be regenerated and signed at least once per year using the <a href="keygen.html"><tt>ntp-keygen</tt> - generate public and private keys</a> program.</p>
<p>The following error codes are reported via the NTP control and monitoring protocol trap mechanism and to the <tt>cryptostats</tt> monitoring file if configured.</p>
<dl>
  <dt>101 bad field format or length</dt>
  <dd>The packet has invalid version, length or format.</dd>
  <dt>102 bad timestamp</dt>
  <dd>The packet timestamp is the same or older than the most recent received. This could be due to a replay or a server clock time step.</dd>
  <dt>103 bad filestamp</dt>
  <dd>The packet filestamp is the same or older than the most recent received. This could be due to a replay or a key file generation error.</dd>
  <dt>104 bad or missing public key</dt>
  <dd>The public key is missing, has incorrect format or is an unsupported type.</dd>
  <dt>105 unsupported digest type</dt>
  <dd>The server requires an unsupported digest/signature scheme.</dd>
  <dt>106 unsupported identity type</dt>
  <dd>The client or server has requested an identity scheme the other does not support.</dd>
  <dt>107 bad signature length</dt>
  <dd>The signature length does not match the current public key.</dd>
  <dt>108 signature not verified</dt>
  <dd>The message fails the signature check. It could be bogus or signed by a different private key.</dd>
  <dt>109 certificate not verified</dt>
  <dd>The certificate is invalid or signed with the wrong key.</dd>
  <dt>110 host certificate expired</dt>
  <dd>The old server certificate has expired.</dd>
  <dt>111 bad or missing cookie</dt>
  <dd>The cookie is missing, corrupted or bogus.</dd>
  <dt>112 bad or missing leapseconds table</dt>
  <dd>The leapseconds table is missing, corrupted or bogus.</dd>
  <dt>113 bad or missing certificate</dt>
  <dd>The certificate is missing, corrupted or bogus.</dd>
  <dt>114 bad or missing group key</dt>
  <dd>The identity key is missing, corrupt or bogus.</dd>
  <dt>115 protocol error</dt>
  <dd>The protocol state machine has wedged due to unexpected restart.</dd>
</dl>
<h4 id="file">Files</h4>
<p>See the <a href="keygen.html"><tt>ntp-keygen</tt></a> page. Note that provisions to load leap second values from the NIST files have been removed. These provisions are now available whether or not the OpenSSL library is available. However, the functions that can download these values from servers remains available.</p>
<hr>
<p>
  <script type="text/javascript" language="javascript" src="scripts/footer.txt"></script>
</p>
</body>
</html>
