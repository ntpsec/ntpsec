.job_template: &job_definition
  stage: build
  artifacts:
    expire_in: 7d
    paths:
      - build/main/attic/sht
      - build/main/ntpclients/ntpdig
      - build/main/ntpclients/ntpkeygen
      - build/main/ntpclients/ntpleapfetch
      - build/main/ntpclients/ntploggps
      - build/main/ntpclients/ntplogtemp
      - build/main/ntpclients/ntpmon
      - build/main/ntpclients/ntpq
      - build/main/ntpclients/ntpsweep
      - build/main/ntpclients/ntptrace
      - build/main/ntpclients/ntpviz
      - build/main/ntpclients/ntpwait
      - build/main/ntpd/ntpd
      - build/main/ntpfrob/ntpfrob

gitlab-basic:
  <<: *job_definition
  script:
    - apt-get update -qq && apt-get install -y -qq bison libcap-dev pps-tools python-dev
    - python ./waf configure build
  tags:
    - gitlab-org

gitlab-refclocks:
  <<: *job_definition
  script:
    - apt-get update -qq && apt-get install -y -qq bison libcap-dev pps-tools python-dev
    - python ./waf configure --refclock=all build
  tags:
    - gitlab-org

debian-wheezy-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - debian-wheezy

debian-wheezy-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - debian-wheezy

debian-jessie-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - debian-jessie

debian-jessie-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - debian-jessie

gcc-7-basic:
  <<: *job_definition
  image: gcc:7
  script:
    - apt-get update -qq && apt-get install -y -qq bison libcap-dev pps-tools python-dev
    - python ./waf configure build
  tags:
    - gitlab-org

gcc-7-refclocks:
  <<: *job_definition
  image: gcc:7
  script:
    - apt-get update -qq && apt-get install -y -qq bison libcap-dev pps-tools python-dev
    - python ./waf configure --refclock=all build
  tags:
    - gitlab-org

freebsd-11-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - freebsd-11

freebsd-11-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - freebsd-11

centos-6-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - centos-6

centos-6-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - centos-6

centos-7-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - centos-7

centos-7-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - centos-7

fedora-24-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - fedora-24

fedora-24-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - fedora-24

fedora-25-basic:
  <<: *job_definition
  script:
    - python ./waf configure build
  tags:
    - fedora-25

fedora-25-refclocks:
  <<: *job_definition
  script:
    - python ./waf configure --refclock=all build
  tags:
    - fedora-25

